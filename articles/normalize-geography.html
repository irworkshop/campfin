<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Normalize Geographic Variables â€¢ campfin</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Normalize Geographic Variables">
<meta property="og:description" content="campfin">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">campfin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.10.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/normalize-geography.html">Normalize Geographic Variables</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/irworkshop/campfin/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="normalize-geography_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Normalize Geographic Variables</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/irworkshop/campfin/blob/HEAD/vignettes/normalize-geography.Rmd" class="external-link"><code>vignettes/normalize-geography.Rmd</code></a></small>
      <div class="hidden name"><code>normalize-geography.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/irworkshop/campfin" class="external-link">campfin</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"campfin"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] '1.0.10.9001'</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>This vignette contains an example of the workflow used by the wranglers on <a href="https://www.publicaccountability.org/" class="external-link">The Accountability Project</a>, a tool created by <a href="https://investigativereportingworkshop.org/" class="external-link">The Investigative Reporting Workshop</a> in Washington, DC. The Accountability Project curates, cleans, and indexes public data to give journalists, researchers, and the public a simple way to search across otherwise siloed records. The data focuses on people, organizations and locations.</p>
<p>Since state-level campaign finance data is typically reported by the campaigns and provided to them by the contributors themselves, there is often great disparity in data quality. The campfin package was created to reduce this disparity in a consistent, confident, and programmatic way.</p>
</div>
<div class="section level2">
<h2 id="messy-data">Messy Data<a class="anchor" aria-label="anchor" href="#messy-data"></a>
</h2>
<p>In this vignette, we will clean some exaggerated fake messy contribution data from a fictitious campaign in Vermont. This data is found in the <code>vt_contribs.csv</code> file included with our package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"vt_contribs.csv"</span>, package <span class="op">=</span> <span class="st">"campfin"</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="2%">
<col width="11%">
<col width="10%">
<col width="6%">
<col width="12%">
<col width="23%">
<col width="13%">
<col width="7%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">id</th>
<th align="left">cand</th>
<th align="left">date</th>
<th align="left">amount</th>
<th align="left">name</th>
<th align="left">address</th>
<th align="left">city</th>
<th align="left">state</th>
<th align="left">zip</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">01</td>
<td align="left">Bob Miller</td>
<td align="left">02/09/2019</td>
<td align="left">10</td>
<td align="left">Lisa Miller</td>
<td align="left">4 Sheffield square Road</td>
<td align="left">Sheffield</td>
<td align="left">VT</td>
<td align="left">05866</td>
</tr>
<tr class="even">
<td align="left">02</td>
<td align="left">Bob Miller</td>
<td align="left">03/09/2009</td>
<td align="left">20</td>
<td align="left">Deb Brown</td>
<td align="left">Requested</td>
<td align="left">Requested</td>
<td align="left">RE</td>
<td align="left">00000</td>
</tr>
<tr class="odd">
<td align="left">03</td>
<td align="left">Chuck White</td>
<td align="left">04/09/2019</td>
<td align="left">25</td>
<td align="left">N/A</td>
<td align="left">p.o. box 567</td>
<td align="left">Midlebury</td>
<td align="left">Vermont</td>
<td align="left">05753-0567</td>
</tr>
<tr class="even">
<td align="left">04</td>
<td align="left">Chuck White</td>
<td align="left">05/09/2019</td>
<td align="left">100</td>
<td align="left">Josh Jones</td>
<td align="left">sugarhouse SQU</td>
<td align="left">e Corinth</td>
<td align="left">VT</td>
<td align="left">5076</td>
</tr>
<tr class="odd">
<td align="left">05</td>
<td align="left">Bob Miller</td>
<td align="left">02/09/2019</td>
<td align="left">10</td>
<td align="left">Lisa Miller</td>
<td align="left">4 Sheffield square Road</td>
<td align="left">Sheffield</td>
<td align="left">VT</td>
<td align="left">05866</td>
</tr>
<tr class="even">
<td align="left">06</td>
<td align="left">Chuck White</td>
<td align="left">06/09/2019</td>
<td align="left">1000</td>
<td align="left">Bob Taylor</td>
<td align="left">55 thisplace av</td>
<td align="left">young america</td>
<td align="left">mn</td>
<td align="left">55555</td>
</tr>
<tr class="odd">
<td align="left">07</td>
<td align="left">Chuck White</td>
<td align="left">07/09/2019</td>
<td align="left">-600</td>
<td align="left">Alex Johnson</td>
<td align="left">11 Liberty AVN</td>
<td align="left">Bristol, VT</td>
<td align="left">VT</td>
<td align="left">99999</td>
</tr>
<tr class="even">
<td align="left">08</td>
<td align="left">Alice Walsh</td>
<td align="left">08/09/2019</td>
<td align="left">0</td>
<td align="left">Ruth Smith</td>
<td align="left">2 Burlington sqre</td>
<td align="left">Brulington</td>
<td align="left">vt</td>
<td align="left">05401</td>
</tr>
<tr class="odd">
<td align="left">09</td>
<td align="left">Alice Walsh</td>
<td align="left">09/09/2019</td>
<td align="left">69</td>
<td align="left">Joe Garcia</td>
<td align="left">770 5th-st-nw</td>
<td align="left">Washington</td>
<td align="left">D.C.</td>
<td align="left">20001-2674</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">Alice Walsh</td>
<td align="left">11/09/2019</td>
<td align="left">222</td>
<td align="left">Dave Wilson</td>
<td align="left">XXXXXXXXXXXXXXXXX</td>
<td align="left">SA</td>
<td align="left">Texas</td>
<td align="left">78202</td>
</tr>
</tbody>
</table>
<p>What are some of the potential problems we can see in this data?</p>
<ul>
<li>The <code>date</code> column is not parsed as an R date, making it impossible to perform mathematical calculations like <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min()</a></code>.</li>
<li>There is one negative <code>amount</code> value and another thatâ€™s zero. Not necessarily uncommon, but worth noting.</li>
<li>One record is missing both the contributorâ€™s <code>name</code>.</li>
<li>One record is duplicated across every column.</li>
<li>In <code>address</code> we see:
<ul>
<li>Inconsistent capitalization.</li>
<li>A mix of full and abbreviated suffixes.</li>
<li>Alternative versions of <code>NA</code>.</li>
<li>Unnecessary and inconsistent punctuation.</li>
<li>Excess trailing and internal white space.</li>
<li>Incorrect punctuation and replaced spaces.</li>
<li>Repeating character strings used instead of <code>NA</code>.</li>
</ul>
</li>
<li>In <code>city</code> we see many of the same problems, plus:
<ul>
<li>Geographic abbreviations.</li>
<li>Repeated <code>state</code> information.</li>
<li>Misspellings.</li>
<li>Colloquial city abbreviations.</li>
</ul>
</li>
<li>In <code>state</code> we see a mix of full and abbreviated state names.</li>
<li>In <code>zip</code>:
<ul>
<li>Repeated digits used for <code>NA</code> values (NB: 55555 is a valid ZIP code, 99999 is not).</li>
<li>Unnecessary and inconsistent <a href="https://en.wikipedia.org/wiki/ZIP_Code#ZIP+4" title="zip4" class="external-link">ZIP+4</a> usage.</li>
<li>Leading zeroes <a href="https://support.microsoft.com/en-us/office/display-numbers-as-postal-codes-61b55c9f-6fe3-4e54-96ca-9e85c38a5a1d?ui=en-us&amp;rs=en-us&amp;ad=us" title="excel" class="external-link">dropped by Excel</a> or some other program.</li>
</ul>
</li>
</ul>
<p>While this data is obviously much smaller and more full of errors than real campaign finance data, these errors are not uncommon and need to be addressed. The campfin package contains many of the tools we need to first find and then fix these common problems.</p>
</div>
<div class="section level2">
<h2 id="read">Read<a class="anchor" aria-label="anchor" href="#read"></a>
</h2>
<p>In most cases, the first step is to download and read the file from a state agency. When reading the data with the popular <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_delim()</a></code> function, the <code><a href="../reference/col_date_mdy.html">col_date_mdy()</a></code> function can be used as a quick shortcut for <code>readr::col_date(format = "%m/%d/%Y")</code>, the format most commonly found in U.S. campaign finance data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="va">ex_file</span>,</span>
<span>  trim_ws <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"N/A"</span><span class="op">)</span>,</span>
<span>  col_types <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html" class="external-link">cols</a></span><span class="op">(</span></span>
<span>    amount <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html" class="external-link">col_number</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    date <span class="op">=</span> <span class="fu"><a href="../reference/col_date_mdy.html">col_date_mdy</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can see how the new <code>date</code> column is an actual date object, allowing for mathematical manipulation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">vt</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2009-03-09"</span></span></code></pre></div>
<p>Next, we should try to normalize our data as much as possible. We can use some simple counting functions and built in vectors to check the cleanliness of our raw data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prop_in.html">prop_in</a></span><span class="op">(</span><span class="va">vt</span><span class="op">$</span><span class="va">city</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_lower</a></span><span class="op">(</span><span class="va">valid_city</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1</span></span>
<span><span class="fu"><a href="../reference/prop_in.html">prop_in</a></span><span class="op">(</span><span class="va">vt</span><span class="op">$</span><span class="va">state</span>, <span class="va">valid_state</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4</span></span>
<span><span class="fu"><a href="../reference/prop_in.html">prop_in</a></span><span class="op">(</span><span class="va">vt</span><span class="op">$</span><span class="va">zip</span>, <span class="va">valid_zip</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/col_stats.html">col_stats</a></span><span class="op">(</span><span class="va">vt</span>, <span class="va">n_distinct</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 Ã— 4</span></span></span>
<span><span class="co">#&gt;   col     class      n     p</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> id      &lt;chr&gt;     10   1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> cand    &lt;chr&gt;      3   0.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> date    &lt;date&gt;     9   0.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> amount  &lt;dbl&gt;      9   0.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> name    &lt;chr&gt;      9   0.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> address &lt;chr&gt;      9   0.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> city    &lt;chr&gt;      9   0.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> state   &lt;chr&gt;      7   0.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span> zip     &lt;chr&gt;      9   0.9</span></span>
<span><span class="fu"><a href="../reference/col_stats.html">col_stats</a></span><span class="op">(</span><span class="va">vt</span>, <span class="va">count_na</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 Ã— 4</span></span></span>
<span><span class="co">#&gt;   col     class      n     p</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> id      &lt;chr&gt;      0   0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> cand    &lt;chr&gt;      0   0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> date    &lt;date&gt;     0   0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> amount  &lt;dbl&gt;      0   0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> name    &lt;chr&gt;      1   0.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> address &lt;chr&gt;      0   0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> city    &lt;chr&gt;      0   0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> state   &lt;chr&gt;      0   0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span> zip     &lt;chr&gt;      0   0</span></span></code></pre></div>
<p>A typical benchmark is to reach greater than 95% <em>valid</em>. That is, we want to normalize our data enough that less than 5% of our data can not be easily confirmed as valid using a fairly comprehensive list of cities, states, and ZIP codes.</p>
<p>We will first try to reach this threshold by normalizing our data. This process involves reducing inconsistencies through string manipulation. There are separate <code>normal_*()</code> functions for each of the 4 types of geographic variables. Typically we use <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> to create <em>new</em>, normalized versions of our messy columns, preserving the old data for transparency. Here, we will just overwrite our example data for simplicity.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vt</span> <span class="op">&lt;-</span> <span class="va">vt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    address <span class="op">=</span> <span class="fu"><a href="../reference/normal_address.html">normal_address</a></span><span class="op">(</span></span>
<span>      address <span class="op">=</span> <span class="va">address</span>,</span>
<span>      abbs <span class="op">=</span> <span class="va">usps_street</span>,</span>
<span>      na <span class="op">=</span> <span class="va">invalid_city</span>,</span>
<span>      na_rep <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    city <span class="op">=</span> <span class="fu"><a href="../reference/normal_city.html">normal_city</a></span><span class="op">(</span></span>
<span>      city <span class="op">=</span> <span class="va">city</span>,</span>
<span>      abbs <span class="op">=</span> <span class="va">usps_city</span>,</span>
<span>      states <span class="op">=</span> <span class="st">"VT"</span>,</span>
<span>      na <span class="op">=</span> <span class="va">invalid_city</span></span>
<span>    <span class="op">)</span>,</span>
<span>    state <span class="op">=</span> <span class="fu"><a href="../reference/normal_state.html">normal_state</a></span><span class="op">(</span></span>
<span>      state <span class="op">=</span> <span class="va">state</span>,</span>
<span>      abbreviate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      na_rep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      valid <span class="op">=</span> <span class="va">valid_state</span></span>
<span>    <span class="op">)</span>,</span>
<span>    zip <span class="op">=</span> <span class="fu"><a href="../reference/normal_zip.html">normal_zip</a></span><span class="op">(</span></span>
<span>      zip <span class="op">=</span> <span class="va">zip</span>,</span>
<span>      na_rep <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We can see how these functions and our built in data was used to normalize the geographic contributor data and remove anything that didnâ€™t present real information. This format is much more easily explored and search.</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 Ã— 4</span></span></span>
<span><span class="co">#&gt;    address               city          state zip  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 4 SHEFFIELD SQUARE RD SHEFFIELD     VT    05866</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #BB0000;">NA</span>                    <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> PO BOX 567            MIDLEBURY     VT    05753</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> SUGARHOUSE SQ         EAST CORINTH  VT    5076 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 4 SHEFFIELD SQUARE RD SHEFFIELD     VT    05866</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 55 THISPLACE AVE      YOUNG AMERICA MN    55555</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 11 LIBERTY AVE        BRISTOL       VT    <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2 BURLINGTON SQ       BRULINGTON    VT    05401</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 770 5THSTNW           WASHINGTON    DC    20001</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #BB0000;">NA</span>                    SA            TX    78202</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="cities">Cities<a class="anchor" aria-label="anchor" href="#cities"></a>
</h2>
<p>However, the problem has not been solved. City names are the most troublesome; There are so many city names and such great variety (compared to states and ZIP codes), that it can be difficult to normalize and difficult to assess.</p>
<p>Our <code>valid_city</code> vector contains many city names, but far less than exist in the country, especially when you account for neighborhoods that arenâ€™t <em>really</em> cities, but shouldnâ€™t be changed (some of these are contained in our curated <code>extra_city</code> vector).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">valid_city</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 19083</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">valid_city</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "GERMANSVILLE" "BAXTER"       "HALLOWELL"    "ANIWA"        "LUCIEN"      </span></span>
<span><span class="co">#&gt; [6] "LOOMIS"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">extra_city</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "BROWNDALE"             "UPPER DUBLIN TOWNSHIP" "WEST BOUNTIFUL"       </span></span>
<span><span class="co">#&gt; [4] "WHITAKER"              "CANADIAN LAKES"        "LAKEMOOR"</span></span>
<span><span class="co"># combine both vectors</span></span>
<span><span class="va">many_city</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">valid_city</span>, <span class="va">extra_city</span><span class="op">)</span></span></code></pre></div>
<p>Still, checking against this list is a good way to check for values that need additional attention.</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 Ã— 5</span></span></span>
<span><span class="co">#&gt;   id    city       state zip   valid</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 03    MIDLEBURY  VT    05753 FALSE</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 08    BRULINGTON VT    05401 FALSE</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 10    SA         TX    78202 FALSE</span></span></code></pre>
<p>It might not be clear whatâ€™s actually wrong with these values. A common way to check is by comparing them against <em>expected</em> city for a given ZIP code.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">bad</span>,</span>
<span>  y <span class="op">=</span> <span class="va">zipcodes</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"zip"</span>, <span class="st">"state"</span><span class="op">)</span>, </span>
<span>  suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_raw"</span>, <span class="st">"_match"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">id</th>
<th align="left">city_raw</th>
<th align="left">state</th>
<th align="left">zip</th>
<th align="left">city_match</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">03</td>
<td align="left">MIDLEBURY</td>
<td align="left">VT</td>
<td align="left">05753</td>
<td align="left">MIDDLEBURY</td>
</tr>
<tr class="even">
<td align="left">08</td>
<td align="left">BRULINGTON</td>
<td align="left">VT</td>
<td align="left">05401</td>
<td align="left">BURLINGTON</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="left">SA</td>
<td align="left">TX</td>
<td align="left">78202</td>
<td align="left">SAN ANTONIO</td>
</tr>
</tbody>
</table>
<p>Now the problems become clear. Two city names are misspelled and the third is an obvious abbreviation. When dealing with millions of city names, we need a way to check each raw value against itâ€™s expected ZIP code match.</p>
<p>The <code><a href="../reference/str_dist.html">str_dist()</a></code> and <code><a href="../reference/is_abbrev.html">is_abbrev()</a></code> functions can be used to compared the value we have with the value we expect. By only checking against the corresponding city to that recordâ€™s ZIP code, we are making extremely <em>confident</em> changes (compared to the incredibly useful clustering algorithms like those provided by the <code>refinr</code> package).</p>
<p>First, we can use <code><a href="../reference/str_dist.html">str_dist()</a></code> to check the <em>distance</em> between the two strings; distance is defined as the number of changes weâ€™d need to make to our normalized value to get our expected matched value. If that distance is small (usually 1 or 2), we can pretty confidently use the matched value.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/str_dist.html">str_dist</a></span><span class="op">(</span><span class="st">"example"</span>, <span class="st">"xampel"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>But the string distance does not catch colloquial city abbreviations (e.g., NYC, BOS, LA, CHI, ABQ, BRNX, DFW, OKC). Many residents get so used to writing their cityâ€™s name they use abbreviations and assume them to be universally understood. The <code><a href="../reference/is_abbrev.html">is_abbrev()</a></code> function can be used to check to one string might be an abbreviation for another. Every abbreviation generated by the <code><a href="https://rdrr.io/r/base/abbreviate.html" class="external-link">abbreviate()</a></code> function satisfied the requirements of <code><a href="../reference/is_abbrev.html">is_abbrev()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is_abbrev.html">is_abbrev</a></span><span class="op">(</span>abb <span class="op">=</span> <span class="st">"NYC"</span>, full <span class="op">=</span> <span class="st">"New York City"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/is_abbrev.html">is_abbrev</a></span><span class="op">(</span>abb <span class="op">=</span> <span class="st">"DC"</span>, full <span class="op">=</span> <span class="st">"Washington"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bad</span> <span class="op">&lt;-</span> <span class="va">bad</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    match_dist <span class="op">=</span> <span class="fu"><a href="../reference/str_dist.html">str_dist</a></span><span class="op">(</span><span class="va">city_raw</span>, <span class="va">city_match</span><span class="op">)</span>,</span>
<span>    match_abb <span class="op">=</span> <span class="fu"><a href="../reference/is_abbrev.html">is_abbrev</a></span><span class="op">(</span><span class="va">city_raw</span>, <span class="va">city_match</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">id</th>
<th align="left">city_raw</th>
<th align="left">state</th>
<th align="left">zip</th>
<th align="left">city_match</th>
<th align="right">match_dist</th>
<th align="left">match_abb</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">03</td>
<td align="left">MIDLEBURY</td>
<td align="left">VT</td>
<td align="left">05753</td>
<td align="left">MIDDLEBURY</td>
<td align="right">1</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">08</td>
<td align="left">BRULINGTON</td>
<td align="left">VT</td>
<td align="left">05401</td>
<td align="left">BURLINGTON</td>
<td align="right">1</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="left">SA</td>
<td align="left">TX</td>
<td align="left">78202</td>
<td align="left">SAN ANTONIO</td>
<td align="right">9</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>Hereâ€™s what this process would look like when employed on an entire data frame. Itâ€™s important to ensure that the number of rows in our campaign finance data is kept consistent throughout the wrangling process and that original columns are left unchanged.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vt</span> <span class="op">&lt;-</span> <span class="va">vt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>city_raw <span class="op">=</span> <span class="va">city</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># match city by ZIP</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">zipcodes</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>city_match <span class="op">=</span> <span class="va">city</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># check against match</span></span>
<span>    match_dist <span class="op">=</span> <span class="fu"><a href="../reference/str_dist.html">str_dist</a></span><span class="op">(</span><span class="va">city_raw</span>, <span class="va">city_match</span><span class="op">)</span>,</span>
<span>    match_abb <span class="op">=</span> <span class="fu"><a href="../reference/is_abbrev.html">is_abbrev</a></span><span class="op">(</span><span class="va">city_raw</span>, <span class="va">city_match</span><span class="op">)</span>,</span>
<span>    city <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">match_abb</span> <span class="op">|</span> <span class="va">match_dist</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">city_match</span>, <span class="va">city_raw</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># remove intermediary columns</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">city_raw</span>, <span class="op">-</span><span class="va">city_match</span>, <span class="op">-</span><span class="va">match_dist</span>, <span class="op">-</span><span class="va">match_abb</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(state, zip)`</span></span></code></pre></div>
<p>Now every <code>city</code>, <code>state</code>, and <code>zip</code> value is contained in our list of valid values.</p>
<table class="table">
<thead><tr class="header">
<th align="left">id</th>
<th align="left">state</th>
<th align="left">zip</th>
<th align="left">city</th>
<th align="left">all_valid</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">01</td>
<td align="left">VT</td>
<td align="left">05866</td>
<td align="left">SHEFFIELD</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">03</td>
<td align="left">VT</td>
<td align="left">05753</td>
<td align="left">MIDDLEBURY</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">05</td>
<td align="left">VT</td>
<td align="left">05866</td>
<td align="left">SHEFFIELD</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">06</td>
<td align="left">MN</td>
<td align="left">55555</td>
<td align="left">YOUNG AMERICA</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">08</td>
<td align="left">VT</td>
<td align="left">05401</td>
<td align="left">BURLINGTON</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">09</td>
<td align="left">DC</td>
<td align="left">20001</td>
<td align="left">WASHINGTON</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="left">TX</td>
<td align="left">78202</td>
<td align="left">SAN ANTONIO</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>Once our data is as normal as we can confidently make it, we can begin to explore. First, weâ€™ll explore the data for missing values with <code><a href="../reference/flag_na.html">flag_na()</a></code>, which takes a <a href="https://github.com/r-lib/tidyselect" title="tidyselect" class="external-link">tidyselect</a> input of columns (or something like <code><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">dplyr::everything()</a></code>).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">vt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flag_na.html">flag_na</a></span><span class="op">(</span><span class="va">vt</span>, <span class="va">name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 Ã— 10</span></span></span>
<span><span class="co">#&gt;    id    cand        date       amount name    address state zip   city  na_flag</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 01    Bob Miller  2019-02-09     10 Lisa Mâ€¦ 4 SHEFâ€¦ VT    05866 SHEFâ€¦ FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 02    Bob Miller  2009-03-09     20 Deb Brâ€¦ <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 03    Chuck White 2019-04-09     25 <span style="color: #BB0000;">NA</span>      PO BOXâ€¦ VT    05753 MIDDâ€¦ TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 04    Chuck White 2019-05-09    100 Josh Jâ€¦ SUGARHâ€¦ VT    5076  <span style="color: #BB0000;">NA</span>    FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 05    Bob Miller  2019-02-09     10 Lisa Mâ€¦ 4 SHEFâ€¦ VT    05866 SHEFâ€¦ FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 06    Chuck White 2019-06-09   <span style="text-decoration: underline;">1</span>000 Bob Taâ€¦ 55 THIâ€¦ MN    55555 YOUNâ€¦ FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 07    Chuck White 2019-07-09   -<span style="color: #BB0000;">600</span> Alex Jâ€¦ 11 LIBâ€¦ VT    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 08    Alice Walsh 2019-08-09      0 Ruth Sâ€¦ 2 BURLâ€¦ VT    05401 BURLâ€¦ FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 09    Alice Walsh 2019-09-09     69 Joe Gaâ€¦ 770 5Tâ€¦ DC    20001 WASHâ€¦ FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10    Alice Walsh 2019-11-09    222 Dave Wâ€¦ <span style="color: #BB0000;">NA</span>      TX    78202 SAN â€¦ FALSE</span></span></code></pre></div>
<p>Next, weâ€™ll want to check for duplicate rows using <code><a href="../reference/flag_dupes.html">flag_dupes()</a></code>, which takes the same kind of arguments. Here, we can ignore the supposedly unique <code>id</code> variable. Itâ€™s possible for a person to make the same contribution on the same date, but we should flag them nonetheless.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">vt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flag_dupes.html">flag_dupes</a></span><span class="op">(</span><span class="va">vt</span>, <span class="op">-</span><span class="va">id</span>, .both <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 Ã— 11</span></span></span>
<span><span class="co">#&gt;    id    cand  date       amount name  address state zip   city  na_flag dupe_â€¦Â¹</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 01    Bob â€¦ 2019-02-09     10 Lisaâ€¦ 4 SHEFâ€¦ VT    05866 SHEFâ€¦ FALSE   TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 02    Bob â€¦ 2009-03-09     20 Deb â€¦ <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    FALSE   FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 03    Chucâ€¦ 2019-04-09     25 <span style="color: #BB0000;">NA</span>    PO BOXâ€¦ VT    05753 MIDDâ€¦ TRUE    FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 04    Chucâ€¦ 2019-05-09    100 Joshâ€¦ SUGARHâ€¦ VT    5076  <span style="color: #BB0000;">NA</span>    FALSE   FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 05    Bob â€¦ 2019-02-09     10 Lisaâ€¦ 4 SHEFâ€¦ VT    05866 SHEFâ€¦ FALSE   TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 06    Chucâ€¦ 2019-06-09   <span style="text-decoration: underline;">1</span>000 Bob â€¦ 55 THIâ€¦ MN    55555 YOUNâ€¦ FALSE   FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 07    Chucâ€¦ 2019-07-09   -<span style="color: #BB0000;">600</span> Alexâ€¦ 11 LIBâ€¦ VT    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    FALSE   FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 08    Alicâ€¦ 2019-08-09      0 Ruthâ€¦ 2 BURLâ€¦ VT    05401 BURLâ€¦ FALSE   FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 09    Alicâ€¦ 2019-09-09     69 Joe â€¦ 770 5Tâ€¦ DC    20001 WASHâ€¦ FALSE   FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10    Alicâ€¦ 2019-11-09    222 Daveâ€¦ <span style="color: #BB0000;">NA</span>      TX    78202 SAN â€¦ FALSE   FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â€¦ with abbreviated variable name Â¹â€‹dupe_flag</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclude">Conclude<a class="anchor" aria-label="anchor" href="#conclude"></a>
</h2>
<p>This normalized data is now ready to be uploaded to the Accountability Project and searched alongside <a href="https://investigativereportingworkshop.org/2021/02/17/1-billion-records-and-counting-the-accountability-project-reaches-new-milestone/" class="external-link"><em>1 billion</em> other records</a>! These cleaned names and addresses might bring up search results alongside one of our other sets of public data: campaign expenditures, registered voters, nonprofit organizations, stimulus spending, government contracts, lobbyist registrations, etc.</p>
<table class="table">
<colgroup>
<col width="2%">
<col width="10%">
<col width="9%">
<col width="6%">
<col width="11%">
<col width="19%">
<col width="5%">
<col width="5%">
<col width="12%">
<col width="7%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">id</th>
<th align="left">cand</th>
<th align="left">date</th>
<th align="right">amount</th>
<th align="left">name</th>
<th align="left">address</th>
<th align="left">state</th>
<th align="left">zip</th>
<th align="left">city</th>
<th align="left">na_flag</th>
<th align="left">dupe_flag</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">01</td>
<td align="left">Bob Miller</td>
<td align="left">2019-02-09</td>
<td align="right">10</td>
<td align="left">Lisa Miller</td>
<td align="left">4 SHEFFIELD SQUARE RD</td>
<td align="left">VT</td>
<td align="left">05866</td>
<td align="left">SHEFFIELD</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">02</td>
<td align="left">Bob Miller</td>
<td align="left">2009-03-09</td>
<td align="right">20</td>
<td align="left">Deb Brown</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">03</td>
<td align="left">Chuck White</td>
<td align="left">2019-04-09</td>
<td align="right">25</td>
<td align="left">NA</td>
<td align="left">PO BOX 567</td>
<td align="left">VT</td>
<td align="left">05753</td>
<td align="left">MIDDLEBURY</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">04</td>
<td align="left">Chuck White</td>
<td align="left">2019-05-09</td>
<td align="right">100</td>
<td align="left">Josh Jones</td>
<td align="left">SUGARHOUSE SQ</td>
<td align="left">VT</td>
<td align="left">5076</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">05</td>
<td align="left">Bob Miller</td>
<td align="left">2019-02-09</td>
<td align="right">10</td>
<td align="left">Lisa Miller</td>
<td align="left">4 SHEFFIELD SQUARE RD</td>
<td align="left">VT</td>
<td align="left">05866</td>
<td align="left">SHEFFIELD</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">06</td>
<td align="left">Chuck White</td>
<td align="left">2019-06-09</td>
<td align="right">1000</td>
<td align="left">Bob Taylor</td>
<td align="left">55 THISPLACE AVE</td>
<td align="left">MN</td>
<td align="left">55555</td>
<td align="left">YOUNG AMERICA</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">07</td>
<td align="left">Chuck White</td>
<td align="left">2019-07-09</td>
<td align="right">-600</td>
<td align="left">Alex Johnson</td>
<td align="left">11 LIBERTY AVE</td>
<td align="left">VT</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">08</td>
<td align="left">Alice Walsh</td>
<td align="left">2019-08-09</td>
<td align="right">0</td>
<td align="left">Ruth Smith</td>
<td align="left">2 BURLINGTON SQ</td>
<td align="left">VT</td>
<td align="left">05401</td>
<td align="left">BURLINGTON</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">09</td>
<td align="left">Alice Walsh</td>
<td align="left">2019-09-09</td>
<td align="right">69</td>
<td align="left">Joe Garcia</td>
<td align="left">770 5THSTNW</td>
<td align="left">DC</td>
<td align="left">20001</td>
<td align="left">WASHINGTON</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">Alice Walsh</td>
<td align="left">2019-11-09</td>
<td align="right">222</td>
<td align="left">Dave Wilson</td>
<td align="left">NA</td>
<td align="left">TX</td>
<td align="left">78202</td>
<td align="left">SAN ANTONIO</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kiernan Nicholls, Yanqi Xu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
