<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wrangle Campaign Finance Data • campfin</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Wrangle Campaign Finance Data">
<meta property="og:description" content="Explore and normalize American campaign finance
    data. Created by the Investigative Reporting Workshop to facilitate
    work on The Accountability Project, an effort to collect public data
    into a central, standard database that is more easily searched:
    &lt;https://publicaccountability.org/&gt;.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">campfin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.5.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/normalize-geography.html">Normalize Geographic Variables</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/irworkshop/campfin/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="campfin-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#campfin-" class="anchor"></a>campfin <img src="reference/figures/logo.png" align="right" width="120">
</h1></div>
<!-- badges: start -->

<p>The campfin package was created to facilitate the work being done on the <a href="https://www.publicaccountability.org/">The Accountability Project</a>, a tool created by <a href="https://investigativereportingworkshop.org/">The Investigative Reporting Workshop</a> in Washington,</p>
<p>DC. The Accountability Project curates, cleans, and indexes public data to give journalists, researchers and others a simple way to search across otherwise siloed records.</p>
<p>The data focuses on people, organizations and locations. This package was created specifically to help with state-level campaign finance data, although the tools included are useful in general database exploration and normalization.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of campfin from <a href="https://cran.r-project.org/package=campfin">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"campfin"</span><span class="op">)</span></code></pre></div>
<p>The development version can be installed from <a href="https://github.com/irworkshop/campfin">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"irworkshop/campfin"</span><span class="op">)</span></code></pre></div>
</div>
<div id="normalize" class="section level2">
<h2 class="hasAnchor">
<a href="#normalize" class="anchor"></a>Normalize</h2>
<p>The package was originally built to normalize geographic data using the <code>normal_*()</code> functions, which take the messy self-reported geographic data of a contributor, vendor, candidate, or committee and return <a href="https://en.wikipedia.org/wiki/Text_normalization">normalized text</a> that is more searchable. They are largely wrappers around the <a href="https://github.com/tidyverse/stringr">stringr</a> package, and can call other sub-functions to streamline normalization.</p>
<ul>
<li>
<code><a href="reference/normal_address.html">normal_address()</a></code> takes a <em>street</em> address and reduces inconsistencies.</li>
<li>
<code><a href="reference/normal_zip.html">normal_zip()</a></code> takes <a href="https://en.wikipedia.org/wiki/ZIP_Code">ZIP Codes</a> and aims to return a valid 5-digit code.</li>
<li>
<code><a href="reference/normal_state.html">normal_state()</a></code> takes US states and returns a <a href="https://en.wikipedia.org/wiki/List_of_U.S._state_abbreviations">2 digit abbreviation</a>.</li>
<li>
<code><a href="reference/normal_city.html">normal_city()</a></code> takes cities and reduces inconsistencies.</li>
<li>
<code><a href="reference/normal_phone.html">normal_phone()</a></code> consistently formats US telephone numbers.</li>
</ul>
<p>Please see the vignette on normalization for an example of how these functions are used to fix a wide variety of string inconsistencies and make campaign finance data more consistent. In general, these functions fix the following inconsistencies:</p>
<ul>
<li>Capitalize with <code>str_to_upper()</code>
</li>
<li>Replace hyphens and underscores with <code>str_replace()</code>
</li>
<li>Remove remaining punctuation with <code>str_remove()</code>
</li>
<li>Remove either numbers or letters (depending on data) with <code>str_remove()</code>
</li>
<li>Remove excess white space with <code>str_trim()</code> and <code>str_squish()</code>
</li>
<li>Abbreviate addresses with <code><a href="reference/abbrev_full.html">abbrev_full()</a></code> (and <code>str_replace_all()</code>)</li>
<li>Remove invalid values with <code><a href="reference/na_out.html">na_out()</a></code> (and <code>str_which()</code>)</li>
</ul>
</div>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">zipcode</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">zip_url</span> <span class="op">&lt;-</span> <span class="st">"https://cran.r-project.org/src/contrib/Archive/zipcode/zipcode_1.0.tar.gz"</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="va">zip_url</span>, repos <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">zipcode</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/irworkshop/campfin">campfin</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></code></pre></div>
<p>The campfin package contains a number of built in data frames and strings used to help wrangle campaign finance data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#&gt;  [1] "dark2"        "extra_city"   "invalid_city" "rx_phone"     "rx_state"     "rx_url"      </span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt;  [7] "rx_zip"       "usps_city"    "usps_state"   "usps_street"  "valid_abb"    "valid_city"  </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; [13] "valid_name"   "valid_state"  "valid_zip"    "zipcodes"</span></span></code></pre></div>
<p>The <code>/data-raw</code> directory contains the code used to create the objects.</p>
<div id="zipcodes" class="section level3">
<h3 class="hasAnchor">
<a href="#zipcodes" class="anchor"></a>zipcodes</h3>
<p>The <code>zipcodes</code> (plural) table is a new version of the <code>zipcode</code> (singular) table from the archived <a href="https://cran.r-project.org/src/contrib/Archive/zipcode/">zipcode</a> R package.</p>
<blockquote>
<p>This database was composed using ZIP code gazetteers from the US Census Bureau from 1999 and 2000, augmented with additional ZIP code information The database is believed to contain over 98% of the ZIP Codes in current use in the United States. The remaining ZIP Codes absent from this database are entirely PO Box or Firm ZIP codes added in the last five years, which are no longer published by the Census Bureau, but in any event serve a very small minority of the population (probably on the order of .1% or less). Although every attempt has been made to filter them out, this data set may contain up to .5% false positives, that is, ZIP codes that do not exist or are no longer in use but are included due to erroneous data sources.</p>
</blockquote>
<p>The included <code>valid_city</code> and <code>valid_zip</code> vectors are sorted, unique columns from the <code>zipcodes</code> data frame.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># zipcode version</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"zipcode"</span><span class="op">)</span>
<span class="fu">sample_n</span><span class="op">(</span><span class="va">zipcode</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;     zip        city state latitude longitude</span>
<span class="co">#&gt; 1 15697   Youngwood    PA 40.23813 -79.58172</span>
<span class="co">#&gt; 2 25090 Glen Ferris    WV 38.14906 -81.21276</span>
<span class="co">#&gt; 3 22969    Schuyler    VA 37.79234 -78.69417</span>

<span class="co"># campfin version</span>
<span class="fu">sample_n</span><span class="op">(</span><span class="va">zipcodes</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;   city      state zip  </span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 ALHAMBRA  CA    91801</span>
<span class="co">#&gt; 2 LONG LAKE NY    12847</span>
<span class="co">#&gt; 3 AUGUSTA   MT    59410</span></code></pre></div>
</div>
<div id="usps_-and-valid_" class="section level3">
<h3 class="hasAnchor">
<a href="#usps_-and-valid_" class="anchor"></a><code>usps_*</code> and <code>valid_*</code>
</h3>
<p>The <code>usps_*</code> data frames were scraped from the official United States Postal Service (USPS) <a href="https://pe.usps.com/text/pub28/28apc_002.htm">Postal Addressing Standards</a>. These data frames are designed to work with the abbreviation functionality of <code><a href="reference/normal_address.html">normal_address()</a></code> and <code><a href="reference/normal_city.html">normal_city()</a></code> to replace common abbreviations with their full equivalent.</p>
<p><code>usps_city</code> is a curated subset of <code>usps_state</code>, whose full version appear at least once in the <code>valid_city</code> vector from <code>zipcodes</code>. The <code>valid_state</code> and <code>valid_name</code> vectors contain the columns from <code>usps_state</code> and include territories not found in R’s build in <code>state.abb</code> and <code>state.name</code> vectors.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">sample_n</span><span class="op">(</span><span class="va">usps_street</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;   full  abb  </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 VIEW  VW   </span>
<span class="co">#&gt; 2 HWAY  HWY  </span>
<span class="co">#&gt; 3 UNION UN</span>
<span class="fu">sample_n</span><span class="op">(</span><span class="va">usps_state</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;   full                 abb  </span>
<span class="co">#&gt;   &lt;chr&gt;                &lt;chr&gt;</span>
<span class="co">#&gt; 1 NEBRASKA             NE   </span>
<span class="co">#&gt; 2 ARMED FORCES PACIFIC AP   </span>
<span class="co">#&gt; 3 VERMONT              VT</span>
<span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span><span class="op">(</span><span class="va">valid_state</span>, <span class="va">state.abb</span><span class="op">)</span>
<span class="co">#&gt;  [1] "AS" "AA" "AE" "AP" "DC" "FM" "GU" "MH" "MP" "PW" "PR" "VI"</span></code></pre></div>
<hr>
<p>The campfin project is released with a <a href="https://www.contributor-covenant.org/version/2/0/code_of_conduct.html">Contributor Code of Conduct</a>. By contributing, you agree to abide by its terms.</p>
<!-- refs: start -->
<!-- refs: end -->
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=campfin">https://​cloud.r-project.org/​package=campfin</a>
</li>
<li>Browse source code at <br><a href="https://github.com/irworkshop/campfin/">https://​github.com/​irworkshop/​campfin/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/irworkshop/campfin/issues">https://​github.com/​irworkshop/​campfin/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Kiernan Nicholls <br><small class="roles"> Author, maintainer, copyright holder </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle: maturing"></a></li>
<li><a href="https://CRAN.R-project.org/package=campfin"><img src="https://www.r-pkg.org/badges/version/campfin" alt="CRAN status"></a></li>
<li><a href="https://codecov.io/gh/irworkshop/campfin?branch=master"><img src="https://img.shields.io/codecov/c/github/irworkshop/campfin/master.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/irworkshop/campfin/actions"><img src="https://github.com/irworkshop/campfin/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Kiernan Nicholls.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
